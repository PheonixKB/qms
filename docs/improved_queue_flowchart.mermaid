flowchart TB
    Start([System Access]) --> UserType{User Type?}
    
    %% Customer Flow
    UserType -->|Customer| SelectService[Select Service]
    SelectService --> BookChoice{Booking Type?}
    BookChoice -->|Walk-in| CheckCapacity{Capacity OK?}
    BookChoice -->|Schedule| BookAppt[Book Appointment]
    CheckCapacity -->|Yes| IssueToken[Issue Digital Token]
    CheckCapacity -->|No| BookAppt
    BookAppt --> OnArrival[Arrive & Check-in]
    IssueToken --> Priority{Priority?}
    Priority -->|Yes| VerifyID[Verify ID] --> PQ[Priority Queue]
    Priority -->|No| RQ[Regular Queue]
    OnArrival --> RQ
    PQ --> Wait[Wait & Track Time]
    RQ --> Wait
    Wait --> Called[Token Called]
    Called --> GracePeriod{Arrived?}
    GracePeriod -->|Yes| Service[Service]
    GracePeriod -->|Grace| Service
    GracePeriod -->|Missed| Expired[Expired]
    
    %% Service Provider Flow
    UserType -->|Provider| Login[Login]
    Login --> ViewQueue[View Queue]
    ViewQueue --> CallNext[Call Next]
    CallNext --> Service
    Service --> Outcome{Outcome?}
    Outcome -->|Complete| Complete[Complete] --> Feedback[Feedback]
    Outcome -->|Transfer| Transfer[Transfer] --> Wait
    Outcome -->|Reschedule| Reschedule[Reschedule]
    Outcome -->|No Show| NoShow[No Show]
    Outcome -->|Emergency| Emergency[Alert]
    
    %% Admin Flow
    UserType -->|Admin| AdminDash[Dashboard]
    AdminDash --> UserMgmt[Users]
    AdminDash --> RoleMgmt[Roles]
    AdminDash --> ServiceMgmt[Services]
    AdminDash --> SystemConfig[Config]
    AdminDash --> AuditLog[Audit]
    AdminDash --> DataBackup[Backup]
    
    %% Styling
    style Start fill:#4caf50,stroke:#2e7d32,stroke-width:3px,color:#fff
    style Feedback fill:#4caf50,stroke:#2e7d32,stroke-width:3px,color:#fff
    style Expired fill:#ef5350,stroke:#c62828,stroke-width:2px,color:#fff
    style UserType fill:#fff59d,stroke:#f57f17,stroke-width:2px
    style BookChoice fill:#fff59d,stroke:#f57f17,stroke-width:2px
    style CheckCapacity fill:#fff59d,stroke:#f57f17,stroke-width:2px
    style Priority fill:#fff59d,stroke:#f57f17,stroke-width:2px
    style GracePeriod fill:#fff59d,stroke:#f57f17,stroke-width:2px
    style Outcome fill:#fff59d,stroke:#f57f17,stroke-width:2px
    style SelectService fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    style IssueToken fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    style VerifyID fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    style PQ fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    style RQ fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    style Wait fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    style Called fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    style BookAppt fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    style OnArrival fill:#e1f5fe,stroke:#0277bd,stroke-width:2px
    style Login fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    style ViewQueue fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    style CallNext fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    style Service fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    style Complete fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    style Transfer fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    style Reschedule fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    style NoShow fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    style Emergency fill:#f3e5f5,stroke:#6a1b9a,stroke-width:2px
    style AdminDash fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style UserMgmt fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style RoleMgmt fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style ServiceMgmt fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style SystemConfig fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style AuditLog fill:#fff3e0,stroke:#e65100,stroke-width:2px
    style DataBackup fill:#fff3e0,stroke:#e65100,stroke-width:2px